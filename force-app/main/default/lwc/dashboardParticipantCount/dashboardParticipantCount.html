<template>
    <div class="slds-card rr-white-panel db-qal-container">
        <div class="siteDBtitle" >
            &nbsp;&nbsp; {dashboardTitle}
        </div>
        <!-- Spinner to display when waiting for results of search -->
        <template if:true={loading}>
            <lightning-spinner
                alternative-text="Loading"
                size="small"
            ></lightning-spinner>
        </template>
   
         <div class="db-qal-items slds-grid slds-wrap db-section" style="height: 200px;margin-top: 15px">
            <div class="barContainer">
                <div class="slds-col slds-size--3-of-12 barTitle  slds-align_absolute-right"  style="margin-bottom: 10px;">
                    <!--{invitedRec.title}-->
                    {topBarLabel}  
                </div>
                <div class="slds-size--9-of-12 barGrp" style="margin-bottom: 10px">
                    <div class="bar"  style={topBarStyle} ></div>
                        <div class="barText" style="margin-left: 10px; display: inline-block" >
                            {topBarRec.count } {participantText}
                        </div>                            
                    
                    </div>
                </div>
                <div class="barContainer">
                    <div class="slds-col slds-size--3-of-12 barTitle  slds-align_absolute-right" style="margin-bottom:10px">
                        {secondBarLabel}  
                    </div>
                    <div class="slds-size--9-of-12 barGrp" style="margin-bottom: 10px">
                        <div class="bar"  style={secondBarStyle} ></div>
                        <div class="barText" style="margin-left: 10px;display: inline-block" >
                            {secondBarRec.count } {participantText}
                        </div>
    
                    </div>
                </div>
                
            
		</div>
      
        <footer class="siteDB-footer">
            <div>
                <p class="thick" onclick={openParticipantModal} style="cursor: pointer;">
                    {buttonText}
                </p>
            </div>
        </footer>
    <!-- Send Invites to Not Yet Invited Popup -->
        <template if:true={isParticipantModalOpen}>
            <c-popup-l-w-c show-modal=true onclose={closeParticipantModal} header2=true header-value2={label.InviteModalTitle} 
            modalsize="small" style="width: 40%;border-radius: 3px;">
                <div slot="body" class="processBody">                    
                    <div class="slds-form-element" style="padding-left: 1rem;">
                        <div class="db-qal-items slds-grid slds-wrap slds-scrollable">
                            <span class="processTextBody">
                            <template if:true={popupLoading}>
                                <lightning-spinner
                                    alternative-text="Loading"
                                    size="small"
                                ></lightning-spinner>
                            </template>
                            <table>
                                <thead>
                                    <tr><th scope="col" style="width: 2rem">                                        
                                    </th>
                                    <th scope="col" >
                                        <span><p onclick={selectAll} class="thick1" style="cursor: pointer;margin-left: -2rem;" >{label.SelectAll}</p></span>                                        
                                    </th></tr>
                                </thead>
                            <tbody>  
                                <template for:each={peList} for:item="pe">
                                    <tr key={pe}>
                                        <td>
                                            <lightning-input style="margin-bottom: 0.5rem;"
                                                type="checkbox"
                                                checked={pe.isChecked}
                                                data-id={pe.datasetId}
                                                onchange={doRecordSelection}>                                         
                                            </lightning-input>
                                        </td>
                                        <td>
                                            <div class="table-patientrow" style="margin-bottom: 0.5rem;"
                                                title={pe.participantName} if:false={pe.delegateId}>
                                                {pe.participantName}
                                            </div>
                                            <div class="table-patientrow" style="margin-bottom: 0.5rem;"
                                                title={pe.participantName} if:true={pe.delegateId}>
                                            {pe.delegateParticipantName} ({pe.participantName})
                                            </div>
                                        </td>                                      
                                    </tr>
                                </template>  
                            </tbody>
                            </table>
                            </span>
                        </div>
                    </div>
                    
                    <footer class="siteDB-footer">
                        <div class="modal_btns">
                            <span class="slds-float--right">
                                <button type="button" class="apollo-btn primary btn"
                                disabled={disableButton}
                                onclick={sendToSelected}>{label.InviteSelected}</button>
                            </span>
                            <span class="slds-float--right">
                                <button type="button" class="apollo-btn tertiary btn"  onclick={closeParticipantModal}>{label.Cancel}</button>
                            </span>
                        </div>
                    </footer>
              </div>
            </c-popup-l-w-c>

        </template>
    <!--  END -->

   <!-- View Participants Not Yet Logged In Popup -->
        <template if:true={isParticipantModalOpenlogin}>
        <c-popup-l-w-c show-modal=true onclose={closeParticipantModal} header2=true header-value2={label.LoginModalTitle} 
        modalsize="small" style="width: 40%;border-radius: 3px;">
            <div slot="body" class="processBody">                    
                <div class="slds-form-element" style="padding-left: 1rem;">
                    <div class="db-qal-items slds-grid slds-wrap slds-scrollable">
                        <span class="processTextBody">
                        <template if:true={popupLoading}>
                            <lightning-spinner
                                alternative-text="Loading"
                                size="small"
                            ></lightning-spinner>
                        </template>
                        <table>
                         
                        <tbody>  
                            <template for:each={peList} for:item="pe">
                                <tr key={pe}>                                       
                                    <td>
                                        <div class="table-patientrow" style="margin-bottom: 0.5rem;"
                                            title={pe.participantName} if:false={pe.delegateId}>
                                            {pe.participantName}
                                        </div>
                                        <div class="table-patientrow" style="margin-bottom: 0.5rem;"
                                            title={pe.participantName} if:true={pe.delegateId}>
                                        {pe.delegateParticipantName} ({pe.participantName})
                                        </div>
                                    </td>                                      
                                </tr>
                            </template>  
                        </tbody>
                        </table>
                        </span>
                    </div>
                </div>
                
                <footer class="siteDB-footer">
                    <div class="modal_btns">
                        <span class="slds-float--right">
                            <button type="button" class="apollo-btn tertiary btn"  onclick={closeParticipantModal}>{label.Cancel}</button>
                        </span>
                    </div>
                </footer>
          </div>
        </c-popup-l-w-c>

        </template>
    

    </div>
</template>