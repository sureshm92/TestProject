<!--
 - Created by Igor Malyuta on 06.12.2019.
 -->

<!-- Visits Path -->
<template>
    <div class="path-panel">
        <c-web-spinner fixed="true"></c-web-spinner>
        <template if:false={isVisitsEmpty}>
            <div class="path-section">
                <div class="slds-grid">
                    <div class="slds-col arrow-left" style="padding-right: 0;">
                        <div onclick={handleScrollLeft} class="arrow-border">
                            <i>
                                <span><c-web-icon icon-name="icon-chevron-left" icon-color="#297DFD" icon-width="18"
                                        icon-height="18"></c-web-icon></span>
                            </i>
                        </div>
                    </div>
                    <div class="slds-col" style="overflow-x: hidden; padding-right: 0; padding-left: 0;">
                        <div class="slds-grid vis-path">
                            <template for:each={pathItems} for:item="pathItem">
                                <div key={pathItem.id} class={pathItem.state}>
                                    <div class="slds-grid">
                                        <div class={pathItem.left}></div>
                                        <div class={pathItem.right} style="position: relative">
                                            <div class="state-ico-wrapper-large">
                                            </div>
                                            <div class="state-ico-wrapper-middle">
                                            </div>
                                            <div class="state-ico-wrapper">
                                                <c-web-icon icon-width="13" icon-height="14" icon-name={pathItem.icon}
                                                            icon-color="white"></c-web-icon>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="state-label">{pathItem.visitName}</div>
                                    <div class="state-label">
                                        <template if:false={pathItem.isPending}>{pathItem.complDate}</template>
                                        <template if:true={pathItem.isPending}>
                                            <template if:true={pathItem.planDate}>
                                                <div class="date-edit">
                                                    <lightning-formatted-date-time
                                                            value={pathItem.planDate}></lightning-formatted-date-time>
                                                    <div data-id={pathItem.id} onclick={handleOpenDialog}>
                                                        <c-web-icon icon-name="pencil-2" icon-color="#999" icon-size="small"
                                                                    icon-height="16" icon-width="16" style="margin-left: 4px;cursor: pointer;"></c-web-icon>
                                                    </div>
                                                </div>
                                            </template>
                                            <template if:false={pathItem.planDate}>
                                                <a data-id={pathItem.id} class="add-date"
                                                   onclick={handleOpenDialog}>{labels.addLabel}</a>
                                            </template>
                                        </template>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                    <div class="slds-col arrow-right" style="padding-left: 0;">

                        <div onclick={handleScrollRight} class="arrow-border">
                            <i>
                                <span class="arrow-borders-right" style="padding-left: 2px">
                                    <c-web-icon icon-name="icon-chevron-right" icon-color="#297DFD"
                                                icon-width="18" icon-height="18" class=""></c-web-icon>
                                </span>
                            </i>
                        </div>
                    </div>
                </div>
            </div>
        </template>
        <template if:true={isVisitsEmpty}>
            <c-web-empty-list target-list={pathItems}></c-web-empty-list>
        </template>
    </div>
    <!-- Add/Change Visit Planned Date -->
    <c-web-popup show-header="true" show-footer="true" custom-buttons="true" title={labels.planDate}>
        <div slot="body">
            <lightning-input type="date" label={labels.selDate} value={planDate} autocomplete="off"
                             onchange={handleDateChange}></lightning-input>
        </div>
        <div slot="footerButtons">
            <button class="apollo-btn tertiary" onclick={handleHideDialog}>{labels.cancelBTNLabel}</button>
            <button class="apollo-btn primary" onclick={savePlannedDate}>{labels.saveBTNLabel}</button>
        </div>
    </c-web-popup>
</template>