<!--
 - Created by Igor Malyuta on 12.04.2019.
 -->

<aura:component description="StudyVisits" controller="ParticipantVisitsRemote">

    <ltng:require scripts="{!join(',', $Resource.rr_community_js)}" afterScriptsLoaded="{!c.doInit}"/>

    <!--attributes-->
    <aura:attribute name="visits" type="List"/>
    <aura:attribute name="currentVisits" type="List"/>
    <aura:attribute name="initialized" type="Boolean" default="false"/>

    <c:RRSpinner aura:id="spinner" size="medium" showSpinner="true" fixed="true"/>
    <c:RRActionApprove aura:id="popup"
                       dialogTitle="{!$Label.c.Home_Page_StudyVisit_Btn}"
                       message="{!$Label.c.StudyVisit_Popup_Text}"
                       approveBtnName="{!$Label.c.BTN_OK}"
                       cancelBtnName="{!$Label.c.BTN_Cancel}"/>

    <div class="{!'sv-body ' + if(v.initialized, '', 'hidden')}">
        <div class="tt-title">
            {!$Label.c.Home_Page_StudyVisit_Title}
            <button class="apollo-btn primary" onclick="{!c.onTravel}">{!$Label.c.Home_Page_StudyVisit_Btn}</button>
        </div>

        <ui:scrollerWrapper class="rr-white-panel">
            <aura:if isTrue="{!!empty(v.visits)}">
                <c:RRTable>
                    <tr>
                        <th class="sv-t-name">{!$Label.c.Home_Page_StudyVisit_Visit}</th>
                        <th>{!$Label.c.Home_Page_StudyVisit_Schedule}</th>
                        <th class="sv-t-icons">{!$Label.c.Home_Page_StudyVisit_WhToEx}</th>
                    </tr>
                    <aura:iteration var="visit" items="{!v.currentVisits}">
                        <tr>
                            <td class="sv-t-name">{!visit.Name}</td>
                            <td class="sv-t-time">{!visit.Timeplane__c}</td>
                            <td class="sv-t-icons">
                                <c:RRIconSplitter value="{!visit.Icons__c}"/>
                            </td>
                        </tr>
                    </aura:iteration>
                </c:RRTable>
                <div class="pagination">
                    <c:rrPagination allObjects="{!v.visits}" currentObjects="{!v.currentVisits}" entriesOnPage="4"/>
                </div>
            </aura:if>
            <c:EmptyListStub targetList="{!v.visits}" iconName="none"/>
        </ui:scrollerWrapper>

        <c:StudyVisitsLegend/>
    </div>
</aura:component>
