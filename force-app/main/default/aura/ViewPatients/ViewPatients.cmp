<!--
 - Created by Leonid Bartenev
 -->

<aura:component description="ViewPatients"  implements="forceCommunity:availableForAllPageTypes" controller="ViewPatientsRemote">

    <ltng:require styles="{!join(',', $Resource.rr_community_css, $Resource.proximanova + '/proximanova.css')}"
                  scripts="{!join(',', $Resource.rr_community_js)}"
                  afterScriptsLoaded="{!c.doInit}"/>

    <!--attributes:-->
    <aura:attribute name="trialId" type="String"/>
    <aura:attribute name="siteId" type="String"/>
    <aura:attribute name="userMode" type="String"/>
    <aura:attribute name="isInitialized" type="Boolean" default="false" access="private"/>
    <aura:attribute name="emptyListMessage" type="String" access="private" default="{!$Label.c.PG_VP_L_No_Items}"/>
    <aura:attribute name="parent" type="Aura.Component"/>

    <!--handlers:-->
    <aura:handler event="c:EventCommunityInitialized" action="{!c.doInit}"/>


    <!--component body:-->
    <c:RRSpinner aura:id="mainSpinner" size="medium" showSpinner="true" fixed="true"/>

    <div class="rr-min-body-height">
        <aura:if isTrue="{!v.isInitialized}">

                <div class="vp-navigation">
                    <aura:if isTrue="{!empty(v.parent)}">
                            <aura:if isTrue="{!v.userMode == 'PI'}">
                                <div class="navigation-breadcrumbs">
                                <c:RRNavigationPath>
                                    <c:RRNPathItem label="{!$Label.c.PG_RP_L_My_Referrals}"/>
                                </c:RRNavigationPath>
                                <aura:set attribute="else">
                                    <c:RRNavigationPath>
                                        <c:RRNPathItem label="{!$Label.c.PG_VP_L_My_Patients}"/>
                                    </c:RRNavigationPath>
                                </aura:set>
                                </div>
                            </aura:if>
                        <div class="vp-export-btn">
                            <button class="apollo-btn secondary" onclick="{!c.doExport}">
                                    {!$Label.c.BTN_Export_All}
                            </button>
                        </div>

                    </aura:if>
                </div>
            <aura:if isTrue="{!v.userMode == 'HCP'}">
                <c:MedicalRecordReviewLog showStatistics="false" studyFilterEnabled="true" trialId="{!v.trialId}"
                                          header="{!$Label.c.PG_MPS_L_NOT_YET_REFERRED}"/>
            </aura:if>
            <c:ViewPatientsReferred showStatistics="{!v.userMode=='PI'}" studyFilterEnabled="true" trialId="{!v.trialId}" siteId="{!v.siteId}"
                                    header="{!if(v.userMode == 'HCP',$Label.c.PG_MPS_L_REFERRED,'')}" parent="{!v.parent}"/>
        </aura:if>
    </div>
</aura:component>