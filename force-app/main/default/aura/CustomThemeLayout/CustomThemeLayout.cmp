<!--
 - Created by Leonid Bartenev
 -->

<aura:component implements="forceCommunity:themeLayout" controller="CommunityFacadeRemote">
    <ltng:require styles="{!join(',', $Resource.rr_community_css, $Resource.proximanova + '/proximanova.css')}"
                  scripts="{!join(',', $Resource.rr_community_js)}"
                  afterScriptsLoaded="{!c.doInit}"/>

    <!-- attributes: -->
    <aura:attribute name="search" type="Aura.Component[]"/>
    <aura:attribute name="navBar" type="Aura.Component[]"/>
    <aura:attribute name="profileMenu" type="Aura.Component[]"/>
    <aura:attribute name="sidebarFooter" type="Aura.Component[]"/>
    <aura:attribute name="showSideMenu" type="Boolean" default="false"/>
    <aura:attribute name="isInitialized" type="Boolean" default="false"/>

    <aura:attribute name="allModes" type="Object[]"/>
    <aura:attribute name="currentMode" type="Object"/>
    <aura:attribute name="showModeSwitcher" type="Boolean" default="true"/>

    <!-- events: -->
    <!--aura:registerEvent name="EventCommunityInitialized" type="c:EventCommunityInitialized"/-->

    <!-- handlers: -->
    <aura:handler event="c:EventCommunityInitialized" action="{!c.doInit}"/>

    <c:RRSpinner aura:id="spinner" fixed="true" showSpinner="true" size="medium"/>
    <div class="{!'rr-all-content ' + $Browser.formFactor + ' ' + if(v.showSideMenu, ' bodyShift ', ' ') + if(v.availableModes.length > 1, ' with-selector ', '')}">
        <div class="{!'rr-header-content ' + if(v.showModeSwitcher, ' multi-mode', '')}">
            <aura:if isTrue="{!v.isInitialized}">
                <div class="layout-header rr-width-limiter side-padding">
                    <div class="menu-btn" onclick="{!c.switchSideMenu}">
                        <img src="{!$Resource.rr_community_icons + '/menu_btn.png'}" class="chevron" style="height: 32px; width: 32px"/>
                    </div>
                    <div class="logo-container">
                        <img src="{!if(v.currentMode.userMode == 'Participant', $Resource.PH_logo + '/Patient_Portal_Logo.svg', $Resource.rr_community_icons + '/Referral_Hub_Logo.svg')}" class="title-logo" onclick="{!c.doGoHome}"/>
                    </div>

                    <div class="navigation-block">
                        <c:CommunityNavigation mode="{!v.currentMode.userMode}" />
                    </div>
                    <div class="right-block">
                        <c:CommunityModeSwitcher allModes="{!v.allModes}" currentMode="{!v.currentMode}"/>
                        <c:ProfileMenu userMode="{!v.currentMode.userMode}"/>
                    </div>
                </div>
            </aura:if>
        </div>
        <div class="{!'rr-header-margin ' + if(v.showModeSwitcher, ' multi-mode', '')}"></div>
        <div class="rr-body-content rr-min-body-height">
            <aura:if isTrue="{!v.isInitialized}">
                <c:CommunityNavigationMobile showSideMenu="{!v.showSideMenu}" mode="{!v.currentMode.userMode}" class="{!if(v.availableModes.length > 1, ' multi-mode', '')}"/>
                {!v.body}
            </aura:if>
        </div>
        <aura:if isTrue="{!v.isInitialized}">
            <div class="footer">
                <div class="rr-width-limiter" style="padding: 0 15px">
                    <c:CommunityFooter />
                </div>
            </div>
            <c:CookiesInfo/>
        </aura:if>
    </div>

    <c:Alerts userMode="{!v.currentMode.userMode}"/>

</aura:component>