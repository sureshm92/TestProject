<!--
  - Created by Yehor Dobrovolskyi
 -->
<aura:component controller="VisitReportContainerRemote" description="VisitReportContainer"
                implements="forceCommunity:availableForAllPageTypes">

    <ltng:require
            scripts="{!join(',', $Resource.rr_community_js, $Resource.jsPDF + '/jspdf.js', $Resource.jsPDF + '/jspdf.plugin.autotable.min.js')}"
            afterScriptsLoaded=""/>

    <aura:attribute name="multiMode" type="Boolean"/>
    <aura:attribute name="reportDataList" type="Object[]"/>
    <aura:attribute name="reportData" type="Object"/>
    <aura:attribute name="isReportData" type="Boolean"/>
    <aura:attribute name="documentName" type="String" default="Visit Summary Report"/>

    <aura:attribute name="errorMessage" type="String" default=""/>

        <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>

    <div class="{!'sdv-top-bar ' + if(v.multiMode, 'multi-mode', '')}" id="stickyBar" aura:id="stickyBar">
        <div class="navigation rr-width-limiter side-padding">
            <c:RRNavigationPath>
                <c:RRNPathItem label="{!$Label.c.Navigation_Home}" page=""/>
                <c:RRNPathItem label="Past Studies"/>
            </c:RRNavigationPath>
            <div class="rr-width-limiter">
                <img class="contrast-logo" src="{!$Resource.PH_logo + '/iqvia.png'}"/>
            </div>
        </div>
    </div>

    <div class="rr-white-panel">
        <div class="resource-table">
            <div class="resource-title">
                {!$Label.c.Resource_Tab_Study_Documents}
            </div>
            <aura:if isTrue="{!!empty(v.reportDataList)}">
                <c:RRTable>
                    <tr>
                        <th class="study-document-icon"></th>
                        <th class="study-document-title">Study Name</th>
                        <th class="study-document-summary">Document Name</th>
                    </tr>
                    <aura:iteration items="{!v.reportDataList}" var="report" indexVar="ind">
                        <tr class="study-document-row-data">
                            <td class="study-document-icon">
                                <div class="resource-pointer" data-ind="{!ind}" onclick="{!c.onGenerateReport}">
                                    <c:RRIcon
                                            iconName="icon-pdf"
                                            class="resources-icon-pdf"/>
                                </div>
                            </td>
                            <td class="study-document-column-data study-document-title-data">
                                <div onclick="{!c.onGenerateReport}" data-ind="{!ind}"  class="resource-pointer">
                                    {!report.studyCodeName}
                                </div>
                            </td>
                            <td class="study-document-summary study-document-column-data">
                                <a onclick="{!c.onGenerateReport}" data-ind="{!ind}">
                                    {!v.documentName}
                                </a>
                            </td>
                        </tr>
                    </aura:iteration>
                </c:RRTable>
                <aura:set attribute="else">
                    <div class="resource-error-message"> {!$Label.c.Resources_No_Study_Documents}</div>

                </aura:set>
            </aura:if>
            <!--            </footer>-->
            <aura:if isTrue="{!v.errorMessage}">
                <div class="resource-error-message">{!v.errorMessage}</div>
            </aura:if>
        </div>
        <c:RRSpinner aura:id="spinner" showSpinner="true" fixed="true" size="medium"/>
    </div>


    <!--                                          REPORTS                                               -->

    <!--    <aura:if isTrue="{!v.isReportData}">-->
    <div style="position: relative; margin: 20px; display: none" id="content">
<!--    <div style="position: relative; margin: 20px" id="content">-->

        <aura:iteration items="{!v.reportData.dataTables}" var="tableReport" indexVar="ind">
            <div style="text-align: center; font-size:26px; margin-top: 40px; font-weight: bold">{!tableReport.tableName}</div>

            <div style="margin: 15px">
                {!tableReport.textResult}
            </div>


            <table class="slds-table slds-table--bordered" id="{!'tbl' + ind}" border="2">
                <thead>
                <tr class="slds-text-heading--label">
                    <aura:iteration items="{!tableReport.tHead}" var="tableHead">
                        <th style="text-align: center">
                           <span> {!tableHead.colName} </span>
                            <aura:if isTrue="{!tableHead.isShowRange}">
                                <br/>
                                <span style="text-transform: none; font-size:10px; display: block;"> {!' Expected Range ' + tableHead.minValue + ' - ' + tableHead.maxValue}</span>
                            </aura:if>
                        </th>
                    </aura:iteration>
                </tr>
                </thead>
                <tbody>
                <aura:iteration items="{!tableReport.visitResultsWrapper}" var="values">
                    <tr class="slds-hint-parent">
                        <aura:iteration items="{!values}" var="val">
                            <td style="text-align: center">
                                {!val.value}
                            </td>
                        </aura:iteration>
                    </tr>
                </aura:iteration>
                </tbody>
            </table>
        </aura:iteration>
    </div>
</aura:component>
