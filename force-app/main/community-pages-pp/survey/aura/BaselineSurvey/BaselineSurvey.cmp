<!--
 - Created by Leonid Bartenev
 -->

<aura:component
    description="BaselineSurvey"
    controller="BaselineSurveyRemote"
    implements="forceCommunity:availableForAllPageTypes"
>
    <ltng:require scripts="{!$Resource.rr_community_js}" afterScriptsLoaded="{!c.doInit}" />

    <!-- attributes: -->
    <aura:attribute name="initialized" type="Boolean" default="false" />
    <aura:attribute name="codeName" type="String" />
    <aura:attribute name="link" type="String" />
    <aura:attribute name="surveyName" type="String" />
    <aura:attribute name="communityName" type="String" />
    <aura:registerEvent name="ppMobileMenuEvent" type="c:PPMobileMenu" />

    <!-- handlers: -->
    <aura:handler event="c:EventCommunityInitialized" action="{!c.doInit}" />

    <!-- component body: -->
    <c:ExceptionHandlerPopup aura:id="exceptionHandler" />
    <c:RRSpinner aura:id="spinner" size="medium" fixed="true" />

    <aura:if isTrue="{!v.initialized}">
        {!v.communityName}
        <aura:if isTrue="{!v.communityName != 'IQVIA Patient Portal'}">

        <c:RRTopBar
            backLabel="{!$Label.c.PG_MRR_L_Back_to_Study_Workspace}"
            backPage="{!'study-workspace?tab=tab-tasks'}"
            smallTitle="{!v.codeName}"
            bigTitle="{!v.surveyName}"
        >
        </c:RRTopBar>
        </aura:if>
        <aura:if isTrue="{!v.communityName == 'IQVIA Patient Portal'}">
            <div class="pp-survey">
                <c:RRTopBar
                    backLabel="{!$Label.c.BTN_Back}"
                    backPage="{!'tasks'}"
                    smallTitle="{!v.codeName}"
                    bigTitle="{!v.surveyName}"
                >
                </c:RRTopBar>
            </div>
        </aura:if>
        <div class="bls-body rr-all-content">
            <iframe
                id="blsIFrame"
                class="bls-iframe"
                src="{!v.link}"
                onload="{!c.doFrameLoaded}"
            ></iframe>
        </div>

        <div class="rr-width-limiter side-padding">
            <aura:if isTrue="{!v.communityName != 'IQVIA Patient Portal'}">
                <c:CommunityFooter />
                <aura:set attribute="else">
                    <c:ppCommunityFooter aura:id="ppFooter" />
                </aura:set>
             </aura:if>
        </div>
    </aura:if>

    <c:builderStub aura:id="builderStub" />
</aura:component>
