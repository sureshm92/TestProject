<!--
 - Created by Kryvolap Andrii
 -->

<aura:component description="ParticipantInformationPrintView" controller="ParticipantInformationRemote" implements="forceCommunity:availableForAllPageTypes">
    <ltng:require styles="{!join(',', $Resource.rr_community_css, $Resource.proximanova + '/proximanova.css')}"
                  scripts="{!join(',', $Resource.rr_community_js)}" afterScriptsLoaded="{!c.doInit}"/>

    <!-- attributes: -->
    <aura:attribute name="pe" type="Participant_Enrollment__c"/>
    <aura:attribute name="participant" type="Participant__c" access="private"/>
    <aura:attribute name="initialized" type="Boolean" default="false" access="private"/>
    <aura:attribute name="pathItems" type="List"/>
    <aura:attribute name="statusSteps" type="List" access="public"/>
    <aura:attribute name="peStatusesPathList" type="List"/>
    <aura:attribute name="peStatusStateMap" type="Map"/>

    <aura:handler event="c:EventCommunityInitialized" action="{!c.doInit}"/>

    <!-- component body: -->
        <c:RRSpinner aura:id="spinner" size="medium"/>
        <div class="form-content">
            <aura:if isTrue="{!v.initialized}">
                <!--Personal Information-->
                <div class="personal-info-container" id="personalInfoAnchor">
                    <div>
                        <!-- patient details: -->
                        <div class="ap-section">
                            <div class="ap-section-title">{!$Label.c.PG_AP_H_Patient_Details}</div>
                            <div class="slds-grid slds-gutters slds-wrap">
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PG_AS_F_First_name}</div>
                                    <lightning:input type="text" value="{!v.participant.First_Name__c}" disabled="true"/>
                                </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PG_AS_F_Middle_name}</div>
                                    <lightning:input type="text" value="{!v.participant.Middle_Name__c}" disabled="true"/>
                                </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PG_AS_F_Last_name}</div>
                                    <lightning:input type="text" value="{!v.participant.Last_Name__c}" disabled="true"/>
                                </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PG_AS_F_Date_of_Birth}</div>
                                    <lightning:input max="{!v.todayDate}" type="date" value="{!v.participant.Date_of_Birth__c}" disabled="true"/>
                                </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PG_AS_F_Gender}</div>
                                    <lightning:input type="text" value="{!v.participant.Gender__c}" disabled="true"/>
                                </div>
                            </div>
                        </div>
                        <!-- contact information: -->
                        <div class="ap-section">
                            <div class="ap-section-title">{!$Label.c.PG_AP_H_Contact_Information}</div>
                            <div class="slds-grid slds-gutters slds-wrap">
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PG_Ref_L_Primary_daytime_telephone_number}</div>
                                    <lightning:input type="text" value="{!v.participant.Phone__c}" disabled="true"/>
                                </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PG_AP_F_Phone_Type}</div>
                                    <lightning:input type="text" value="{!v.participant.Phone_Type__c}" disabled="true"/>
                                </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PG_AS_F_Email_address}</div>
                                    <lightning:input  aura:id="emailInput" type="email" value="{!v.participant.Email__c}" disabled="true"/>
                                </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PE_Country}</div>
                                    <lightning:input type="text" value="{!v.participant.Mailing_Country_Code__c}" disabled="true"/>
                                </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PE_State}</div>
                                    <lightning:input type="text" value="{!v.participant.Mailing_State_Code__c}" disabled="true"/>
                                </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PG_AS_F_Zip_Postal_Code}</div>
                                    <lightning:input type="text" value="{!v.participant.Mailing_Zip_Postal_Code__c}" disabled="true"/>
                                </div>
                            </div>
                        </div>

                        <!-- referral information -->
                        <div class="ap-section">
                            <div class="ap-section-title">{!$Label.c.PG_AP_H_Referral_Information}</div>
                            <div class="slds-grid slds-gutters slds-wrap">
                                    <div class="rr-form-element slds-col slds-size--1-of-3">
                                        <div class="label">{!$Label.c.PG_AP_F_Patient_Status}</div>
                                        <lightning:input type="text" value="{!v.pe.Participant_Status__c}" disabled="true"/>
                                    </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">
                                        {!$Label.c.PG_AP_F_Referred_By}</div>
                                    <lightning:input type="text" value="{!v.pe.Referred_By__c}" disabled="true"/>
                                </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.PG_AP_F_Screening_Subject_Id}</div>
                                    <lightning:input aura:id="screeningId" type="text" value="{!v.pe.Screening_ID__c}" disabled="true"/>
                                </div>
                                <div class="rr-form-element slds-col slds-size--1-of-3">
                                    <div class="label">{!$Label.c.MRN_Internal_Id}</div>
                                    <lightning:input type="text" value="{!v.pe.MRN_Id__c}" disabled="true"/>
                                </div>
                                    <div class="rr-form-element slds-col slds-size--1-of-3">
                                        <div class="label"></div>
                                        <lightning:input type="text" value="{!v.pe.Visit_Plan__c}" disabled="true"/>
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
                <aura:if isTrue="{!v.pe}">
                    <div id="healthCareProvider">
                        <c:ReferHealthcareProvider pe="{!v.pe}" actionDisabled="true" printMode="true"/>
                    </div>
                </aura:if>
                <!--Status Detail Path-->
                <div class="header">{!$Label.c.BTN_Status_Details}</div>
                <div class="path-panel">
                    <div class="path-section">
                        <c:RRPath2 pathItems="{!v.pathItems}"/>
                    </div>
                </div>

                <!--Status Detail Path Controll-->
                <div class="slds-grid slds-grid_vertical rp-status-detail">
                        <aura:iteration items="{!v.statusSteps}" var="step" indexVar="index">
                            <aura:if isTrue="{!!empty(step.history)}">
                            <div class="{!'slds-col slds-grid pe-state-row ' + if(step.isCurrent, ' current', '')}">
                                <div class="{!'slds-col slds-grid slds-size--1-of-1 path-item-detail-panel rr-white-panel ' + step.state}" style="position: relative">
                                    <div class="slds-col slds-size--4-of-12">
                                        <div class="title">{!step.name}</div>
                                        <!-- history list: -->
                                            <div class="pe-history">
                                                <div class="title">{!$Label.c.PE_Activity_History + ':'}</div>
                                                <aura:iteration items="{!step.history}" var="historyItem" indexVar="hIndex">
                                                    <div class="history-item">
                                                        <div class="{!'info ' + historyItem.styleClass + if(hIndex == 0, ' first', '')}">{!historyItem.message}</div>
                                                        <div class="date">{!$Label.c.PE_Status_History_On_Date + ' '}
                                                            <ui:outputDateTime value="{!historyItem.changeDate}"/><br/>
                                                            <aura:if isTrue="{!step.name == 'Referred'}">
                                                                <aura:if isTrue="{!v.pe.Referral_Source__c == 'HCP'}">
                                                                    <div class="value">{!$Label.c.PG_IMI_L_by_user + ' ' + v.pe.HCP__r.HCP_Contact__r.Name}</div>
                                                                    <aura:set attribute="else">
                                                                        <aura:if isTrue="{!v.pe.Referral_Source__c == 'PI'}">
                                                                            <div class="value">{!$Label.c.PG_IMI_L_by_user + ' ' + v.pe.PI_Contact__r.Name}</div>
                                                                            <aura:set attribute="else">
                                                                                <div class="value">{!$Label.c.PG_IMI_L_by_user + ' ' + v.pe.Source_Type__c}</div>
                                                                            </aura:set>
                                                                        </aura:if>
                                                                    </aura:set>
                                                                </aura:if>
                                                                <aura:set attribute="else">
                                                                    {!$Label.c.PG_IMI_L_by_user + ' ' + historyItem.modifiedBy}
                                                                </aura:set>
                                                            </aura:if>
                                                        </div>
                                                    </div>
                                                </aura:iteration>
                                            </div>
                                    </div>
                                </div>
                            </div>
                            </aura:if>
                        </aura:iteration>
                </div>

                <!--MRR Survey Results-->
                <aura:if isTrue="{!v.pe.MRR_Survey_Results_URL__c &amp;&amp; !v.actions.screenerResponses.disabled}">
                    <div class="header">{!$Label.c.BTN_Screener_Responses}</div>
                    <c:SurveyGismoResultsView results="{!v.pe.MRR_Survey_Results_URL__c}"/>
                </aura:if>

            </aura:if>
        </div>


</aura:component>

