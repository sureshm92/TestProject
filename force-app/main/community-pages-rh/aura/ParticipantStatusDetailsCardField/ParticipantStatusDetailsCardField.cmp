<!--
 - Created by Andrii Kryvolap.
 -->

<aura:component description="ParticipantStatusDetailsCardField">
    <aura:attribute name="parent" type="Aura.Component"/>
    <aura:attribute name="field" type="Object"/>
    <aura:attribute name="editable" type="Boolean" default="true"/>
    <aura:attribute name="required" type="Boolean"/>
    <aura:attribute name="todayDate" type="Date"/>
    <aura:attribute name="previousValue" type="String" default=""/>
    <aura:attribute name="updateInProgress" type="Boolean" default="false"/>
    <aura:attribute name="errorMessage" type="String" default=""/>

    <aura:method name="checkValidity" action="{!c.doCheckValidity}" access="public"/>


    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    <aura:handler name="change" value="{!v.field.value}" action="{!c.onValueChange}"/>
    <div class="{!'slds-col form-field ' + v.field.style }">
        <aura:if isTrue="{!v.field.type=='text'}">
            <lightning:input aura:id="fieldInput" label="{!v.field.title}" type="text" value="{!v.field.value}"
                             disabled="{!v.field.readonly || !v.editable}"
                             required="{!and(!v.field.readonly,and(or(v.required,v.field.dependent), v.field.required))}"
                             onblur="{!c.onBlur}"/>
        </aura:if>
        <aura:if isTrue="{!v.field.type=='picklist'}">
            <div class="label"><aura:if isTrue="{!and(or(v.required,v.field.dependent), v.field.required)}"><abbr title="required" class="slds-required">*</abbr></aura:if>{!v.field.title}</div>
            <c:rrSelect aura:id="selectList" options="{!v.field.values}" value="{!v.field.value}"
                        placeholder="{!$Label.c.PG_AC_Select}"
                        disabled="{!v.field.readonly || !v.editable || and(v.field.smartPicklist, v.field.values.length == 1)}"
                        required="{!and(!v.field.readonly,and(or(v.required,v.field.dependent), v.field.required))}"
                        setValueAsSelected="true" errorMessage="{!v.errorMessage}"/>
        </aura:if>
        <aura:if isTrue="{!v.field.type=='date'}">
            <lightning:input aura:id="fieldInput"
                             label="{!v.field.title}" type="date"
                             min="{!if(v.field.onlyFutureDate,v.todayDate,'')}"
                             max="{!if(v.field.onlyPastDate,v.todayDate,'')}"
                             value="{!v.field.value}"
                             disabled="{!v.field.readonly || !v.editable}"
                             required="{!and(!v.field.readonly,and(or(v.required,v.field.dependent), v.field.required))}"/>
        </aura:if>
        <aura:if isTrue="{!v.field.type=='time'}">
            <lightning:input aura:id="fieldInput"
                             label="{!v.field.title}" type="time" value="{!v.field.value}"
                             min="05:00:00.000Z"
                             max="23:59:00.000Z"
                             disabled="{!v.field.readonly || !v.editable}"
                             required="{!and(!v.field.readonly,and(or(v.required,v.field.dependent), v.field.required))}"/>
        </aura:if>
    </div>

</aura:component>
