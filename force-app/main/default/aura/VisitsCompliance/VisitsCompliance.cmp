<aura:component description="VisitsCompliance" controller="VisitResultsRemote">

    <!-- ATTRIBUTES -->

    <aura:attribute name="contactId" type="Id" required="true"/>
    <aura:attribute name="isVisitResultsExist" type="Boolean" default="false" required="true"/>
    <aura:attribute name="isVisitResultsAvailable" type="Boolean" default="false" required="true"/>
    <aura:attribute name="isOptIn" type="Boolean" default="false" required="true"/>

    <aura:attribute name="optInBody" type="String" access="private"/>
    <aura:attribute name="okButtonClicked" type="Boolean" default="false"
                    description="if primary(Ok) button clicked, this value will change" access="private"/>
    <aura:attribute name="showModal" type="Boolean" default="false" access="private"/>

    <!-- HANDLERS -->

    <aura:handler name="change" value="{!v.okButtonClicked}" action="{!c.changeOptIn}"/>

    <!-- COMPONENT BODY -->

    <div class="rr-white-panel visit-compliance-panel">
        <aura:if isTrue="{!!v.isVisitResultsAvailable}">

            <!-- shareback set to opt-out at the Study or Site levels -->

            <div>
                <lightning:layout class="slds-p-around--large" horizontalAlign="center" verticalAlign="start"
                                  multipleRows="true">
                    <lightning:layoutItem size="12" class="cen visit-assessment-inf">
                        <p class="white-space visit-assessment-inf">{!$Label.c.Visit_Results_Tab_If_Is_Empty_Body}</p>
                    </lightning:layoutItem>
                </lightning:layout>
            </div>

            <!-- -->

            <aura:set attribute="else">
                <aura:if isTrue="{!!v.isOptIn}">

                    <!-- shareback set to opt-out at the Patient level -->

                    <lightning:layout class="slds-p-around--large" horizontalAlign="center" verticalAlign="start">
                        <lightning:layoutItem size="12" class=" visit-assessment-inf" flexibility="shrink">
                            <div aura:id="opt-in-body" style="white-space: pre" >
                                <p>{!$Label.c.Visit_Results_Tab_If_Is_Not_Opt_In + ' '}
                                    <span class="to-modal-link" onclick="{!c.openOptInModal}"> {!$Label.c.Visit_Results_Tab_Linked_Text}</span>
                                    {!$Label.c.Visit_Results_Tab_If_Is_Not_Opt_In_2}  </p>
                            </div>
                        </lightning:layoutItem>
                    </lightning:layout>

                    <!-- -->

                    <aura:set attribute="else">
                        <aura:if isTrue="{!!v.isVisitResultsExist}">

                            <!-- there are not visit results available -->

                            <lightning:layout class="slds-p-around--large" horizontalAlign="center" verticalAlign="start"
                                              multipleRows="true">
                                <lightning:layoutItem size="12" class="cen visit-assessment-inf">
                                    <p class="white-space visit-assessment-inf">{!$Label.c.Visit_Results_Tab_No_Results}</p>
                                </lightning:layoutItem>
                            </lightning:layout>

                            <!-- -->

                        </aura:if>
                    </aura:set>

                </aura:if>
            </aura:set>
        </aura:if>
    </div>

    <c:Popup title="{!$Label.c.Visit_Results_Tab_Modal_Title}" showModal="{!v.showModal}" size="small"
             headerText="{!$Label.c.Visit_Results_Tab_Modal_Body}" primaryButtonClicked="{!v.okButtonClicked}"/>

</aura:component>