<!--
 - Created by Leonid Bartenev
 -->

<aura:component description="OpenTaskPreviewPanel" controller="TasksRemote">

    <!-- attributes: -->
    <aura:attribute name="tasks" type="Task[]"/>
    <aura:attribute name="initialized" type="Boolean" default="false"/>

    <!-- handlers: -->
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>

    <!-- component body: -->
    <c:HomePreviewTablePanel title="Open Task List">
        <c:RRSpinner aura:id="spinner" size="small" showSpinner="true"/>
        <aura:if isTrue="{!v.initialized}">
            <aura:if isTrue="{!!empty(v.tasks)}">
                <c:RRTable>
                    <tr>
                        <th>Name</th>
                        <th style="width:130px">{!$Label.c.Complete_By_Date}</th>
                    </tr>
                    <aura:iteration items="{!v.tasks}" var="task">
                        <tr>
                            <td>
                                <c:RRLink label="{!task.Subject}"
                                          page="{!if(empty(task.Action_URL__c), 'edit-task?id=' + task.Id, task.Action_URL__c)}"/>
                            </td>
                            <td><ui:outputDate value="{!task.ActivityDate}"/></td>
                        </tr>
                    </aura:iteration>
                </c:RRTable>
            </aura:if>
            <c:EmptyListStub targetList="{!v.tasks}" iconName="none"/>
        </aura:if>
        <aura:set attribute="footer">
            <c:RRLink page="study-workspace?tab=tab-tasks" label="See All"/>
        </aura:set>
    </c:HomePreviewTablePanel>

</aura:component>