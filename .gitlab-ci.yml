image: salesforce/salesforcedx:7.82.1-0-full
stages:

  #Validation:
  - SonarCheck
  - VALIDATE

  #5.0 INT
  - DeployINT5.0
  - RunTestINT5.0

  #5.0 INF
  - DeployINF5.0
  - RunTestINF5.0

  #5.1 INT
  - DeployINT5.1
  - RunTestINT5.1
  
  #6.0 INT
  - DeployINT6.0
  - RunTestINT6.0
  
  #6.0 INF
  - DeployINF6.0
  - RunTestINF6.0
  
   #6.1 INT
  -  DeployINT6.1
  - RunTestINT6.1
  
  #6.1 INF
  - DeployINF6.1
  - RunTestINF6.1

#6.1 INT
  - DeployINT6.1
  - RunTestINT6.1
  
  #6.1 INF
  - DeployINF6.1
  - RunTestINF6.1

  
  #5.1 INF
  - DeployINF5.1
  - RunTestINF5.1

 #5.1 INF
  - DeployClonedFml
  - RunTestClonedFml

#6.2 INT
  - DeployCallcenter
  - RunTestCallcenter
  
#6.2 INF
  - DeployINF6.2
  - RunTestINF6.2

cache:
  paths:
    - ~/.sfdx
    - .sfdx


# Validation: ------------------------------------------------------------------
SonarCheck:
  allow_failure: true
  tags:
    - RHPP
  only:
   - merge_requests
  except:
   - push
   - commit
  stage: SonarCheck
  image:
    name: sonarsource/sonar-scanner-cli:latest
    entrypoint: [""]
  cache:
    key: "${CI_JOB_NAME}"
    paths:
      - .sonar/cache
  before_script:
   - echo "Sonar Analysis"
  script:
   - . ./scripts/ci/sonar-check.sh


VALIDATE:
  tags:
    - RHPP
  only:
    - merge_requests
  except:
    - push
    - commit

  stage: VALIDATE
  script:
    - . ./scripts/ci/validate.sh INF62


# 5.0 INT: ---------------------------------------------------------------------
DeployINT5.0:
  #tags:
   # - shell
  only:
    - INT5.0
  except:
    - merge_requests

  stage: DeployINT5.0
  script:
    - . ./scripts/ci/deploy.sh INT5_0

RunTestINT5.0:
  #tags:
   # - shell
  only:
    - INT5.0
  except:
    - merge_requests

  stage: RunTestINT5.0
  script:
    - . ./scripts/ci/run-tests.sh INT5_0



# 5.0 INF: ---------------------------------------------------------------------
DeployINF5.0:
  #tags:
   # - shell
  only:
    - INF5.0
  except:
    - merge_requests

  stage: DeployINF5.0
  script:
    - . ./scripts/ci/deploy.sh INF5_0

RunTestINF5.0:
  #tags:
   # - shell
  only:
    - INF5.0
  except:
    - merge_requests

  stage: RunTestINF5.0
  script:
    - . ./scripts/ci/run-tests.sh INF5_0

# 5.1 INT: ---------------------------------------------------------------------
DeployINT5.1:
  #tags:
   # - shell
  only:
    - INT5.1
  except:
    - merge_requests

  stage: DeployINT5.1
  script:
    - . ./scripts/ci/deploy.sh INT5_1

RunTestINT5.1:
  #tags:
   # - shell
  only:
    - INT5.1
  except:
    - merge_requests

  stage: RunTestINT5.1
  script:
    - . ./scripts/ci/run-tests.sh INT5_1
    
    # 6.0 INT: ---------------------------------------------------------------------
DeployINT6.0:
  #tags:
   # - shell
  only:
    - INT6.0
  except:
    - merge_requests

  stage: DeployINT6.0
  script:
    - . ./scripts/ci/deploy.sh INT60

RunTestINT6.0:
  #tags:
   # - shell
  only:
    - INT6.0
  except:
    - merge_requests

  stage: RunTestINT6.0
  script:
    - . ./scripts/ci/run-tests.sh INT60
    
     # 6.0 INF: ---------------------------------------------------------------------
DeployINF6.0:
  #tags:
   # - shell
  only:
    - INF6.0
  except:
    - merge_requests

  stage: DeployINF6.0
  script:
    - . ./scripts/ci/deploy.sh INF60

RunTestINF6.0:
  #tags:
   # - shell
  only:
    - INF6.0
  except:
    - merge_requests

  stage: RunTestINF6.0
  script:
    - . ./scripts/ci/run-tests.sh INF60
     # 6.1 INT: ---------------------------------------------------------------------
DeployINT6.1:
  #tags:
   # - shell
  only:
    - INT6.1
  except:
    - merge_requests

  stage: DeployINT6.1
  script:
    - . ./scripts/ci/deploy.sh INT61

RunTestINT6.1:
  #tags:
   # - shell
  only:
    - INT6.1
  except:
    - merge_requests

  stage: RunTestINT6.1
  script:
    - . ./scripts/ci/run-tests.sh INT61
    
     # 6.0 INF: ---------------------------------------------------------------------
DeployINF6.1:
  #tags:
   # - shell
  only:
    - INF6.1
  except:
    - merge_requests

  stage: DeployINF6.1
  script:
    - . ./scripts/ci/deploy.sh INF61

RunTestINF6.1:
  #tags:
   # - shell
  only:
    - INF6.1
  except:
    - merge_requests

  stage: RunTestINF6.1
  script:
    - . ./scripts/ci/run-tests.sh INF61

 # 6.2 INT: ---------------------------------------------------------------------
DeployCallcenter:
  #tags:
   # - shell
  only:
    - Callcenter
  except:
    - merge_requests

  stage: DeployCallcenter
  script:
    - . ./scripts/ci/deploy.sh INT62

RunTestCallcenter:
  #tags:
   # - shell
  only:
    - Callcenter
  except:
    - merge_requests

  stage: RunTestCallcenter
  script:
    - . ./scripts/ci/run-tests.sh INT62
    
     # 6.2 INF: ---------------------------------------------------------------------
DeployINF6.2:
  #tags:
   # - shell
  only:
    - INF6.2
  except:
    - merge_requests

  stage: DeployINF6.2
  script:
    - . ./scripts/ci/deploy.sh INF62

RunTestINF6.2:
  #tags:
   # - shell
  only:
    - INF6.2
  except:
    - merge_requests

  stage: RunTestINF6.2
  script:
    - . ./scripts/ci/run-tests.sh INF62 
    # 5.1 INF: ---------------------------------------------------------------------
DeployINF5.1:
  #tags:
   # - shell
  only:
    - INF5.1
  except:
    - merge_requests

  stage: DeployINF5.1
  script:
    - . ./scripts/ci/deploy.sh INF5_1

RunTestINF5.1:
  #tags:
   # - shell
  only:
    - INF5.1
  except:
    - merge_requests

  stage: RunTestINF5.1
  script:
    - . ./scripts/ci/run-tests.sh INF5_1
    # 6.1 INT: ---------------------------------------------------------------------
DeployINT6.1:
  #tags:
   # - shell
  only:
    - INT6.1
  except:
    - merge_requests

  stage: DeployINT6.1
  script:
    - . ./scripts/ci/deploy.sh INT61

RunTestINT6.1:
  #tags:
   # - shell
  only:
    - INT6.1
  except:
    - merge_requests

  stage: RunTestINT6.1
  script:
    - . ./scripts/ci/run-tests.sh INT61
    
     # 6.0 INF: ---------------------------------------------------------------------
DeployINF6.1:
  #tags:
   # - shell
  only:
    - INF6.1
  except:
    - merge_requests

  stage: DeployINF6.1
  script:
    - . ./scripts/ci/deploy.sh INF61

RunTestINF6.1:
  #tags:
   # - shell
  only:
    - INF6.1
  except:
    - merge_requests

  stage: RunTestINF6.1
  script:
    - . ./scripts/ci/run-tests.sh INF61
    

    
 # ClonedFml: ---------------------------------------------------------------------
DeployClonedFml:
  #tags:
   # - shell
  only:
    - Formal
  except:
    - merge_requests

  stage: DeployClonedFml
  script:
    - . ./scripts/ci/deploy.sh Clonedformal

RunTestClonedFml:
  #tags:
   # - shell
  only:
    - Formal
  except:
    - merge_requests

  stage: RunTestClonedFml
  script:
    - . ./scripts/ci/run-tests.sh Clonedformal

