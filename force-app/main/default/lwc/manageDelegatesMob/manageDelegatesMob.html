<template>
    <!--Spinner: Starts-->
    <template if:true={spinner}>
        <lightning-spinner
            alternative-text="Loading"
            variant="brand"
            size="medium"
            class="web-spinner fixed"
        ></lightning-spinner>
    </template>
    <!--Spinner: Ends-->
    <c-web-spinner fixed="true"></c-web-spinner>
    <!-- Show Add Delegate Page: Start-->
    <template if:true={showAddDelegatePage}>
        <c-pp-add-new-delegate
            selected-parent={participantState.Participant_Contact__c}
            is-desktop={isDesktop}
        >
        </c-pp-add-new-delegate>
    </template>
    <!-- Show Add Delegate Page: Ends-->
    <!-- Show Manage Delegate Page: Start-->
    <template if:false={showAddDelegatePage}>
        <!--Desktop View: Starts-->
        <template if:true={isDesktop}>
            <div class={cardRTL}>
                <div class="manage-del-continer">
                    <!--Main Layout: Starts -->
                    <lightning-layout multiple-rows="true">
                        <!-- Manage Delegate Header: Starts-->
                        <lightning-layout-item size="12" class="slds-m-top_small">
                            <span class="manage-delegates-header">
                                {label.PP_ManageDelegates}
                            </span>
                        </lightning-layout-item>
                        <!-- Manage Delegate Header: Ends-->
                        <!--Add Del Button: Starts-->
                        <lightning-layout-item size="12" class="slds-m-top_small">
                            <button
                                title="Non-primary action"
                                onclick={navToAddDelegate}
                                class={addDelBtnMarin}
                            >
                                {label.BTN_Add_New_Delegate}
                            </button>
                        </lightning-layout-item>
                        <!--Iterate over each Delegate Associated to the Participant: Starts-->
                        <template for:each={listPDE} for:item="del" for:index="index">
                            <!--Delegate Card Section: Starts -->
                            <lightning-layout-item
                                size="12"
                                class="del-container m-top-16"
                                key={del.PatientDelegate.Id}
                            >
                                <!--Dlegate Info Layout: Starts -->
                                <lightning-layout multiple-rows="true" class="manage-del-items">
                                    <!--Delegate Profile Logo and Name Section: Starts-->
                                    <lightning-layout-item size="12" class="slds-m-bottom_medium">
                                        <!--Delegate Personal Detail Layout: Starts-->
                                        <lightning-layout multiple-rows="true">
                                            <!--Profile Logo: Stats-->
                                            <lightning-layout-item size="2">
                                                <span><img src={icon_url} /></span>
                                            </lightning-layout-item>
                                            <!--Profile Logo: Ends-->
                                            <!--Delegate Name: Stats-->
                                            <lightning-layout-item size="10"
                                                ><lightning-layout multiple-rows="true">
                                                    <lightning-layout-item
                                                        size="12"
                                                        class="delegate-name"
                                                        >{del.PatientDelegate.First_Name__c}
                                                        {del.PatientDelegate.Last_Name__c}
                                                    </lightning-layout-item>
                                                    <lightning-layout-item
                                                        size="12"
                                                        class="delegate-email"
                                                        >{del.PatientDelegate.Email__c}
                                                    </lightning-layout-item>
                                                </lightning-layout>
                                            </lightning-layout-item>
                                            <!--Delegate Name: Ends-->
                                        </lightning-layout>
                                        <!--Delegate Personal Detail Layout: Ends-->
                                    </lightning-layout-item>
                                    <!--Delegate Profile Logo and Name Section: Ends-->
                                    <!--Iterate over each pdEnrollment Associated to the Delegate: Starts-->
                                    <template
                                        for:each={del.PDEEnrollments}
                                        for:item="pdEnrollment"
                                        for:index="index"
                                    >
                                        <lightning-layout-item
                                            size="12"
                                            class="slds-m-bottom_small study-rectangle"
                                            key={pdEnrollment.Id}
                                        >
                                            <!--Remove Delegate Modal: Starts-->
                                            <template if:true={showpopup}>
                                                <c-pp-remove-delegate-modal-old
                                                    pdenrollmentid={pdEnrollment.Id}
                                                    messtext={modalMesstext}
                                                    tittext={label.PG_PST_L_Delegates_Remove_Himself_Header}
                                                    onconfirmmodal={handleConfirmdelete}
                                                    onmodalclose={handleModalClose}
                                                >
                                                </c-pp-remove-delegate-modal-old>
                                            </template>
                                            <!--Remove Delegate Modal: Ends-->
                                            <lightning-layout multiple-rows="true">
                                                <lightning-layout-item
                                                    size="12"
                                                    padding="around-medium"
                                                    ><p class="study-code-name">
                                                        {pdEnrollment.Participant_Enrollment__r.Clinical_Trial_Profile__r.Study_Code_Name__c}
                                                    </p></lightning-layout-item
                                                >
                                                <lightning-layout-item
                                                    size="12"
                                                    padding="around-medium"
                                                    class="slds-align_absolute-center"
                                                    ><button
                                                        class="remove-btn"
                                                        title="Non-primary action"
                                                        onclick={openRemoveDelegateModal}
                                                        data-id={pdEnrollment.Id}
                                                        data-pdfn={del.PatientDelegate.First_Name__c}
                                                        data-pdln={del.PatientDelegate.Last_Name__c}
                                                    >
                                                        {label.PP_Remove}
                                                    </button></lightning-layout-item
                                                >
                                            </lightning-layout>
                                        </lightning-layout-item>
                                    </template>
                                    <!--Iterate over each pdEnrollment Associated to the Delegate: Starts-->
                                    <!--Add Assignment Button: Starts-->
                                    <lightning-layout-item
                                        size="12"
                                        class="m-top-8 add-assignment-rectangle"
                                    >
                                        <button
                                            class="apollo-btn secondary slds-box width-100"
                                            onclick={addAssignment}
                                        >
                                            <c-web-icon
                                                icon-name="icon-plus"
                                                icon-color="#0768fd"
                                                icon-height="25"
                                                icon-width="18"
                                            ></c-web-icon>
                                            <span class="add-assignment-label"
                                                >&nbsp; Add assignment</span
                                            >
                                        </button>
                                    </lightning-layout-item>
                                    <!--Add Assignment Button: Ends-->
                                </lightning-layout>
                                <!--Dlegate Info Layout: Ends -->
                            </lightning-layout-item>
                            <!--Delegate Card SectionL: Ends -->
                        </template>
                        <!--Iterate over each Delegate Associated to the Participant: Ends-->
                    </lightning-layout>
                    <!--Main Layout: Ends -->
                </div>
            </div>
        </template>
        <!--Desktop View: Ends-->
    </template>
    <!-- Show Manage Delegate Page: Ends-->
</template>
