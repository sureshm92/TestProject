<template>
    <!-- Loading Spinner-->
    <c-web-spinner fixed="true" show-spinner={showSpinner}></c-web-spinner>
    <template if:true={isInitialized}>
        <template if:true={desktop}>
            <template if:true={showProgramOverview}>
                <lightning-layout multiple-rows
                    ><lightning-layout-item size="3" class="slds-p-vertical_small pad-left"
                        ><img src={homeIllustration}
                    /></lightning-layout-item>
                    <lightning-layout-item size="9" class={studyProgramOverviewBoxStyle}>
                        <h2 class="po-fontsize">{userName}</h2>
                        <template if:true={showProgramOverview}>
                            <template if:true={isProgram}>
                                <c-program-overview
                                    clinicalrecord={clinicalrecord}
                                    studysite={studysite}
                                ></c-program-overview>
                            </template>
                            <template if:false={isProgram}>
                                <c-study-overview
                                    clinicalrecord={clinicalrecord}
                                    studysite={studysite}
                                ></c-study-overview>
                            </template>
                        </template> </lightning-layout-item
                ></lightning-layout>
            </template>

            <lightning-layout multiple-rows="true">
                <template if:true={showUpcomingSection}>
                    <lightning-layout-item size="4" class="around-small-custom">
                        <div class="slds-grid card-wrap">
                            <header class="slds-has-flexi-truncate">
                                <h2 class="slds-card__header-title">
                                    <p class="slds-card__header-link slds-truncate upcomingheader">
                                        <span>{label.Upcoming}</span>
                                    </p>
                                </h2>
                            </header>
                        </div>
                        <div
                            class="slds-card__body slds-card__body_inner card-wrap"
                            style="overflow: hidden"
                        >
                            <article
                                class="slds-card slds-card_boundary container-card slds-scrollable_y"
                            >
                                <div class="slds-card__body slds-card__body_inner">
                                    <div style="text-align: center">
                                        <template if:true={showTelevisitCard}>
                                            <template if:true={showVisitCard}>
                                                <template if:true={isTelevisits}>
                                                    <button
                                                        class={visitButtonStyle}
                                                        onclick={visitsTab}
                                                    >
                                                        <template if:true={isProgram}>
                                                            {label.EVENTS}
                                                        </template>
                                                        <template if:false={isProgram}>
                                                            {label.VISITS}
                                                        </template>
                                                    </button>
                                                    <button
                                                        class={televisitButtonStyle}
                                                        onclick={televisitsTab}
                                                    >
                                                        {label.TELEVISITS}
                                                    </button>
                                                </template>
                                                <template if:false={isTelevisits}>
                                                    <button
                                                        class={visitButtonStyle}
                                                        onclick={visitsTab}
                                                    >
                                                        <template if:true={isProgram}>
                                                            {label.EVENTS}
                                                        </template>
                                                        <template if:false={isProgram}>
                                                            {label.VISITS}
                                                        </template>
                                                    </button>
                                                    <button
                                                        class={televisitButtonStyle}
                                                        onclick={televisitsTab}
                                                    >
                                                    {label.TELEVISITS}
                                                    </button>
                                                </template>
                                            </template>
                                        </template>
                                    </div>
                                    <template if:true={isTelevisits}>
                                        <c-pp-televisit-upcoming-tile></c-pp-televisit-upcoming-tile>
                                    </template>
                                    <template if:false={isTelevisits}>
                                        <template if:true={showVisitCard}>
                                            <template if:false={isDelegateSelfview}>
                                                <lightning-layout-item
                                                    size="4"
                                                    class="around-small-custom"
                                                >
                                                    <c-pp-home-page-visits-card
                                                        desktop={desktop}
                                                        is-program={isProgram}
                                                    >
                                                    </c-pp-home-page-visits-card>
                                                </lightning-layout-item>
                                            </template>
                                        </template>
                                    </template>
                                </div>
                            </article>
                        </div>
                    </lightning-layout-item>
                </template>
                <lightning-layout-item size="4" class="around-small-custom">
                    <c-pp-tasks desktop={desktop}></c-pp-tasks>
                </lightning-layout-item>
                <template if:true={showUpcomingSection}>
                    <lightning-layout-item size="4" class={upcomingPaddingStyle}>
                        <c-pp-updates
                            showvisitsection={showUpcomingSection}
                            initial-load-time={initialLoadTime}
                            counter={counter}
                        ></c-pp-updates>
                    </lightning-layout-item>
                </template>
                <template if:false={showUpcomingSection}>
                    <lightning-layout-item
                        size={updateCardLayoutSize}
                        class={updateCardLayoutClass}
                    >
                        <c-pp-updates
                            showvisitsection={updateCardLayoutSmall}
                            initial-load-time={initialLoadTime}
                            counter={counter}
                        ></c-pp-updates>
                    </lightning-layout-item>
                    <lightning-layout-item size="4" class={progressBarLayoutClass}>
                        <template if:true={participantState}>
                            <template if:true={participantState.pe}>
                                <c-pp-progress-bar
                                    parent-class="small"
                                    onprogressbarempty={showBiggerUpdatesSection}
                                    perid={participantState.pe.Id}
                                ></c-pp-progress-bar>
                            </template>
                        </template>
                    </lightning-layout-item>
                </template>
            </lightning-layout>
            <!-- Bottom Congrats Text -->
            <template if:true={showUpcomingSection}>
                <template if:true={participantState}>
                    <template if:true={participantState.pe}>
                        <c-pp-progress-bar perid={participantState.pe.Id}></c-pp-progress-bar>
                    </template>
                </template>
            </template>
        </template>
        <template if:false={desktop}>
            <!--<template if:true={clinicalrecord}>-->
            <template if:true={showProgramOverview}>
                <div>
                    <lightning-layout multiple-rows="true">
                        <lightning-layout-item size="12" class="slds-align_absolute-center">
                            <img src={homeIllustrationMble} />
                        </lightning-layout-item>
                        <lightning-layout-item size="12">
                            <p class="po-fontsize slds-m-horizontal_large slds-m-vertical_small">
                                {userName}
                            </p>
                        </lightning-layout-item>
                        <lightning-layout-item size="12">
                            <!--<template if:true={clinicalrecord}>-->
                            <template if:true={showProgramOverview}>
                                <template if:true={isProgram}>
                                    <c-program-overview
                                        clinicalrecord={clinicalrecord}
                                        studysite={studysite}
                                    ></c-program-overview>
                                </template>
                                <template if:false={isProgram}>
                                    <div class="vl"></div>
                                    <c-study-overview
                                        clinicalrecord={clinicalrecord}
                                        studysite={studysite}
                                    >
                                    </c-study-overview>
                                </template>
                            </template>
                        </lightning-layout-item>
                    </lightning-layout>
                </div>
            </template>

            <!-- cards -->
            <div
                class="slds-grid slds-grid_align-center slds-p-vertical_large slds-p-horizontal_small mobileSet"
            >
                <div class={cardPadding}>
                    <div class="updates" onclick={showUpdatesOnMobile}>
                        <template if:true={updatesSection}>
                            <template if:true={displayCounter}>
                                <div class="update-circle">
                                    <span class="update-count-font">{counterLabel}</span>
                                </div>
                            </template>
                            <div class="icon-update-section-large svg-icon-with-text">
                                <c-web-icon
                                    class="svg-icon"
                                    icon-size="large"
                                    icon-name="reminderbell_icon"
                                    data-id="reminderbell"
                                    icon-color="#ffffff"
                                >
                                </c-web-icon>
                            </div>
                            <div class="vertical updates-darkblue"></div>
                        </template>
                        <template if:false={updatesSection}>
                            <template if:true={displayCounter}>
                                <div class="update-circle">
                                    <span class="update-count-font">{counterLabel}</span>
                                </div>
                            </template>
                            <div class="icon-update-section-small">
                                <c-web-icon
                                    class="svg-icon svg-icon-with-text"
                                    icon-size="medium"
                                    icon-name="reminderbell_icon"
                                    data-id="reminderbell"
                                    icon-color="#ffffff"
                                >
                                </c-web-icon>
                            </div>
                            <p class="p-text">{label.Updates}</p>
                        </template>
                    </div>
                </div>

                <div class={cardPadding}>
                    <div class="tasks" onclick={showTaskList}>
                        <template if:true={taskList}>
                            <div class="icon-updates taskIconPosition">
                                <c-web-icon
                                    class="svg-icon svg-icon-with-text"
                                    icon-size="task_mobile"
                                    icon-name="check-circle-1-alternate"
                                    data-id="checkcirclealternate"
                                    icon-color="#ffffff"
                                >
                                </c-web-icon>
                            </div>
                            <div class="vertical task-pink"></div>
                        </template>
                        <template if:false={taskList}>
                            <div class="icon-updates">
                                <c-web-icon
                                    class="svg-icon svg-icon-with-text"
                                    icon-size="medium"
                                    icon-name="check-circle-1-alternate"
                                    data-id="checkcirclealternate"
                                    icon-color="#ffffff"
                                >
                                </c-web-icon>
                            </div>
                            <p class="p-text">{label.Tasks}</p>
                        </template>
                    </div>
                </div>
                <template if:true={participantState}>
                    <template if:true={participantState.pe}>
                        <template if:true={showProgressMobile}>
                            <div class={cardPadding}>
                                <div class="progress" onclick={showProgressMob}>
                                    <div class={progressIcon}>
                                        <c-web-icon
                                            class="svg-icon svg-icon-with-text"
                                            icon-size={progressIconSize}
                                            icon-name="navigation-menu-horizontal"
                                            data-id="navigationmenuhorizontal"
                                            icon-color="#ffffff"
                                        >
                                        </c-web-icon>
                                    </div>
                                    <p if:false={showProgress} class="p-text">{label.Progress}</p>
                                    <template if:true={showProgress}>
                                        <div class="vertical progress-green"></div>
                                    </template>
                                </div>
                            </div>
                        </template>
                    </template>
                </template>
                <div class={cardPadding}>
                    <!--<template if:true={showVisitCard}>-->
                    <template if:true={showUpcomingSection}>
                        <!--<template if:false={isDelegateSelfview}>-->
                        <template if:true={showVisitCardMobile}>
                            <div class="visit" onclick={showVisitCardOnMobile}>
                                <div class="icon-marg">
                                    <c-web-icon
                                        class="svg-icon"
                                        icon-size="large"
                                        icon-name="calendar"
                                        data-id="calendar"
                                        icon-color="#ffffff"
                                    >
                                    </c-web-icon>
                                </div>
                                <div class="vertical"></div>
                            </div>
                        </template>
                        <template if:false={showVisitCardMobile}>
                            <div class="visit" onclick={showVisitCardOnMobile}>
                                <div class="icon-updates">
                                    <c-web-icon
                                        class="svg-icon svg-icon-with-text"
                                        icon-size="medium"
                                        icon-name="calendar"
                                        data-id="calendar"
                                        icon-color="#ffffff"
                                    >
                                    </c-web-icon>
                                </div>
                                <p class="p-text-televisit">{label.Upcoming}</p>
                                <!--
                                    <template if:true={isProgram}>
                                        <template if:true={isDelegateSelfview}>
                                            <p class="p-text-televisit">{label.TELEVISITS}</p>
                                        </template>
                                        <template if:false={isDelegateSelfview}>
                                            <p class="p-text">{label.EVENTS}</p>
                                        </template>
                                    </template>
                                    <template if:false={isProgram}>
                                        <template if:true={isDelegateSelfview}>
                                            <p class="p-text-televisit">{label.TELEVISITS}</p>
                                        </template>
                                        <template if:false={isDelegateSelfview}>
                                            <p class="p-text">{label.VISITS}</p>
                                        </template>
                                    </template>
                                    -->
                            </div>
                        </template>
                        <!--</template>-->
                    </template>
                </div>
            </div>
            <template if:true={showVisitCardMobile}>
                <div class={tabletUpcomingCard}>
                    <div class="uc-text-mobile">
                        <template if:true={isProgram}> {label.Upcoming_Caps} </template>
                        <template if:false={isProgram}> {label.Upcoming_Caps} </template>
                    </div>
                    <div class={marginbottom}>
                        <template if:true={showVisitCardMobile}>
                            <template if:true={showTelevisitCard}>
                                <template if:true={showVisitCard}>
                                    <div
                                        style="
                                            text-align: center;
                                            background: #f8f9fb;
                                            padding: 8px 0px;
                                        "
                                    >
                                        <template if:true={isTelevisits}>
                                            <button
                                                class={visitButtonStyle}
                                                onclick={visitsTab}
                                            >
                                                <template if:true={isProgram}>
                                                    {label.EVENTS}
                                                </template>
                                                <template if:false={isProgram}>
                                                    {label.VISITS}
                                                </template>
                                            </button>
                                            <button
                                                class={televisitButtonStyle}
                                                onclick={televisitsTab}
                                            >
                                            {label.TELEVISITS}
                                            </button>
                                        </template>
                                        <template if:false={isTelevisits}>
                                            <button
                                                class={visitButtonStyle}
                                                onclick={visitsTab}
                                            >
                                                <template if:true={isProgram}>
                                                    {label.EVENTS}
                                                </template>
                                                <template if:false={isProgram}>
                                                    {label.VISITS}
                                                </template>
                                            </button>
                                            <button
                                                class={televisitButtonStyle}
                                                onclick={televisitsTab}
                                            >
                                            {label.TELEVISITS}
                                            </button>
                                        </template>
                                    </div>
                                </template>
                            </template>
                            <template if:true={showTelevisitCard}>
                                <template if:false={showVisitCard}>
                                    <template if:false={desktop}>
                                        <p
                                            style="
                                                padding: 6px;
                                                text-align: center;
                                                background: rgb(248, 249, 251);
                                            "
                                        ></p>
                                    </template>
                                </template>
                            </template>
                            <template if:false={showTelevisitCard}>
                                <template if:true={showVisitCard}>
                                    <template if:false={desktop}>
                                        <p
                                            style="
                                                padding: 6px;
                                                text-align: center;
                                                background: rgb(248, 249, 251);
                                            "
                                        ></p>
                                    </template>
                                </template>
                            </template>
                        </template>

                        <template if:true={isTelevisits}>
                            <c-pp-televisit-upcoming-tile></c-pp-televisit-upcoming-tile>
                        </template>
                        <template if:true={showVisitCard}>
                            <template if:false={isDelegateSelfview}>
                                <template if:true={showVisitCardMobile}>
                                    <template if:false={isTelevisits}>
                                        <c-pp-home-page-visits-card
                                            desktop={desktop}
                                            is-program={isProgram}
                                        ></c-pp-home-page-visits-card>
                                    </template>
                                </template>
                            </template>
                        </template>
                    </div>
                </div>
            </template>

            <template if:true={taskList}>
                <template if:false={showVisitCardMobile}>
                    <c-pp-tasks desktop={desktop}></c-pp-tasks>
                </template>
            </template>
            <template if:true={updatesSection}>
                <c-pp-updates
                    counter={counter}
                    initial-load-time={initialLoadTime}
                    desktop={desktop}
                ></c-pp-updates>
            </template>
            <div if:true={showProgress}>
                <div class={tabletProgressTab}>{label.MY_PROGRESS_Caps}</div>
                <template if:true={participantState}>
                    <template if:true={participantState.pe}
                        ><lightning-layout class="ipad-width progress-container"
                            ><lightning-layout-item
                                ><c-pp-progress-bar
                                    parent-class="mobile"
                                    perid={participantState.pe.Id}
                                ></c-pp-progress-bar></lightning-layout-item
                        ></lightning-layout>
                    </template>
                </template>
            </div>
        </template>
    </template>
</template>
