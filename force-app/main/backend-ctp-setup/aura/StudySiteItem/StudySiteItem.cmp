<!--
 - Created by Igor Malyuta on 19.09.2019.
 -->

<aura:component description="StudySiteItem">

    <aura:attribute name="item" type="Object"/>
    <aura:attribute name="parent" type="Aura.Component"/>
    <aura:attribute name="viewMode" type="String"/>
    <aura:attribute name="isSingleChoice" type="Boolean" default="false"/>
    <aura:attribute name="conversationsFound" type="Boolean" default="false"/>

    <tr class="{!if(v.item.emptyAssignments, 'empty-assignments', '')}">
        <th data-label="Country" scope="row">
            <div class="slds-truncate"
                 title="">{!v.item.country.label}</div>
        </th>
        <td data-label="Study Site Name">
            <div class="slds-truncate name-overflow" title="">
                <a href="javascript:void(0);" tabindex="-1" data-ssid="{!v.item.ss.Id}"
                   onclick="{!c.viewStudySite}">{!v.item.name}&nbsp;</a>
                <aura:if isTrue="{!v.conversationsFound}">
                    <lightning:helptext content="Messages on this study site are put on hold"
                                        iconName="utility:end_chat"
                                        iconVariant="warning"/>
                </aura:if>
            </div>
        </td>
        <td data-label="Name">
            <div class="slds-truncate"
                 title="">{!v.item.ss.Study_Site_Number__c}</div>
        </td>
        <aura:if isTrue="{!v.isSingleChoice}">
            <td data-label="None" style="text-align: center">
                <div class="slds-truncate" title="">
                    <ui:inputRadio value="{!v.item.emptyAssignments}"
                                   label="none"
                                   change="{!c.sscRadioStateChange}"
                                   disabled="{!v.viewMode != 'Edit'}"/>
                </div>
            </td>
        </aura:if>

        <aura:iteration items="{!v.item.assignments}" var="asg">
            <td style="text-align: center">
                <aura:if isTrue="{!v.isSingleChoice}">
                    <ui:inputRadio value="{!asg.state}"
                                   label="{!asg.value}"
                                   disabled="{!v.viewMode != 'Edit'}"
                                   change="{!c.sscRadioStateChange}"/>
                    <aura:set attribute="else">
                        <ui:inputCheckbox value="{!asg.state}"
                                          label=""
                                          disabled="{!v.viewMode != 'Edit'}"
                                          change="{!c.sscCheckboxStateChange}"/>
                    </aura:set>
                </aura:if>
            </td>
        </aura:iteration>
    </tr>
</aura:component>
