<template>
    <!-- Loading Spinner-->
    <c-web-spinner class="main-spinner" show-spinner={showSpinner}></c-web-spinner>
    <template if:true={isInitialized}>
        <div class="forceOrientation">
            <template lwc:if={desktop}>
                <div class="page-container page-margin">
                    <!--***************  Detail Top Bar  ******************-->
                    <lightning-layout multiple-rows="true">
                        <!-- ************** Back To Resources *************** -->
                        <lightning-layout-item size="12">
                            <span onclick={handleBackClick} class="back-link slds-p-vertical_small">
                                <c-web-icon
                                    icon-size="medium-large"
                                    icon-name="chevron-left"
                                    icon-color="#015ff1"
                                    class="slds-p-right_xx-small"
                                ></c-web-icon
                                >{linkLabel}
                            </span>
                            <hr />
                        </lightning-layout-item>
                        <!-- ***************** Resource Title ******************* -->
                        <template lwc:if={isInvalidResource}>
                            <!--Don't render title-->
                        </template>
                        <template lwc:else>
                            <lightning-layout-item size="12" class="slds-p-vertical_medium">
                                <lightning-layout multiple-rows="true" class="study-title-mobile">
                                    <lightning-layout-item size="12" class="study-title">
                                        {studyTitle}</lightning-layout-item
                                    >
                                    <lightning-layout-item size="12" class="resource-heading">
                                        {resourceTitle}</lightning-layout-item
                                    >
                                </lightning-layout>
                            </lightning-layout-item>
                        </template>
                    </lightning-layout>
                    <template lwc:if={isInvalidResource}>
                        <!-- Don't show <hr / > -->
                    </template>
                    <template lwc:else><hr /></template>

                    <!--****************  Resource Container **********************-->
                    <lightning-layout multiple-rows="true">
                        <!-- *************** Study Documents ****************** -->
                        <template lwc:if={isDocument}>
                            <template lwc:if={isInvalidResource}>
                                <lightning-layout-item size="12" class="resource-container">
                                    <c-pp-invalid-resource
                                        resource-type={resourceType}
                                        onviewresources={handleBackClick}
                                    ></c-pp-invalid-resource>
                                </lightning-layout-item>
                            </template>
                            <template lwc:else>
                                <lightning-layout-item size="12" class="title-row-document">
                                    <div class="ah-video-iframe">
                                        <iframe
                                            frameborder="0"
                                            src={documentLink}
                                            class="my_iframe"
                                        >
                                        </iframe>
                                    </div>
                                </lightning-layout-item>
                            </template>
                        </template>
                        <!--**************  Article/Videos ******************* -->
                        <template lwc:else>
                            <template lwc:if={isInvalidResource}>
                                <lightning-layout-item size="12" class="resource-container">
                                    <c-pp-invalid-resource
                                        resource-type={resourceType}
                                        onviewresources={handleBackClick}
                                    ></c-pp-invalid-resource>
                                </lightning-layout-item>
                            </template>
                            <template lwc:else>
                                <lightning-layout-item size="12" class="resource-container">
                                    <!-- ***************  Resource Container Media ***************** -->
                                    <lightning-layout multiple-rows="true">
                                        <lightning-layout-item size="12">
                                            <c-pp-detail-page-resource-item
                                                resource-link={resourceLink}
                                                resource-type={resourceType}
                                            >
                                            </c-pp-detail-page-resource-item>
                                        </lightning-layout-item>
                                    </lightning-layout>
                                    <!-- ***************** Resource Detail ***********************  -->
                                    <lightning-layout multiple-rows="true">
                                        <lightning-layout-item size="12" class="title-row">
                                            <lightning-layout multiple-rows="true">
                                                <!--   TITLE    -->
                                                <lightning-layout-item size="10">
                                                    <div
                                                        class="summary-title"
                                                        onclick={handleNavigate}
                                                    >
                                                        {resourceTitle}
                                                    </div>
                                                </lightning-layout-item>
                                                <!--   STARICON    -->
                                                <lightning-layout-item size="2">
                                                    <div
                                                        if:false={isMultimedia}
                                                        class="resource-icon resource-pointer"
                                                        onclick={handleFavourite}
                                                    >
                                                        <template if:false={isFavourite}>
                                                            <c-web-icon
                                                                icon-name="icon-star"
                                                                data-id="star"
                                                                data-name="star"
                                                            ></c-web-icon>
                                                        </template>
                                                        <template if:true={isFavourite}>
                                                            <c-web-icon
                                                                icon-name="icon-star-solid"
                                                                data-id="fav-star"
                                                                data-name="fav-star"
                                                                icon-color="#595959"
                                                            ></c-web-icon>
                                                        </template>
                                                    </div>
                                                </lightning-layout-item>
                                            </lightning-layout>
                                        </lightning-layout-item>
                                        <!--   Upload Date    -->
                                        <lightning-layout-item size="12">
                                            <div class="summary-date">
                                                {label.POSTING}&nbsp;
                                                <lightning-formatted-date-time
                                                    value={resUploadDate}
                                                    time-zone={userTimeZone}
                                                >
                                                </lightning-formatted-date-time>
                                            </div>
                                        </lightning-layout-item>
                                        <!--   SUMMARY    -->
                                        <lightning-layout-item size="12">
                                            <div class="summary-text">
                                                <lightning-formatted-rich-text
                                                    value={resourceSummary}
                                                ></lightning-formatted-rich-text>
                                            </div>
                                        </lightning-layout-item>
                                    </lightning-layout>
                                </lightning-layout-item>
                            </template>
                            <!-- Article suggestions-->
                            <lightning-layout-item
                                size="12"
                                class="suggested-container slds-p-top_x-large"
                            >
                                <template lwc:if={isSuggestedArticlesVisible}>
                                    <c-pp-suggested-articles
                                        resid={resourceId}
                                        suggested-articles-data={suggestedArticlesData}
                                        is-invalid={isInvalidResource}
                                    ></c-pp-suggested-articles>
                                </template>
                            </lightning-layout-item>
                        </template>
                    </lightning-layout>
                    <!--*************  Resource Container End *************** -->
                </div>
            </template>
            <template lwc:else>
                <div class="page-container page-margin">
                    <!--***************  Detail Top Bar  ******************-->
                    <lightning-layout multiple-rows="true" class="full-width-container">
                        <!-- ************** Back To Resources *************** -->
                        <div class="portrait-mode">
                            <lightning-layout-item size="12">
                                <span
                                    onclick={handleBackClick}
                                    class="back-link-mobile slds-p-vertical_small"
                                >
                                    <c-web-icon
                                        icon-size="medium-large"
                                        icon-name="chevron-left"
                                        icon-color="#015ff1"
                                        class="slds-p-right_xx-small"
                                    ></c-web-icon
                                    >{linkLabel}
                                </span>
                                <hr />
                            </lightning-layout-item>

                            <!-- ***************** Resource Title ******************* -->
                            <lightning-layout-item size="12" class="slds-p-vertical_medium">
                                <lightning-layout multiple-rows="true" class="study-title-mobile">
                                    <lightning-layout-item size="12" class="study-title">
                                        {studyTitle}</lightning-layout-item
                                    >
                                    <lightning-layout-item size="12" class="resource-heading">
                                        {resourceTitle}</lightning-layout-item
                                    >
                                </lightning-layout>
                                <template if:false={isDocument}> </template>
                            </lightning-layout-item>
                        </div>

                        <div class="mobile-ladscape-back-button">
                            <img src={backToRes} alt="Back to resoruces" onclick={goBackToPrevPage} class="back-to-res"/>
                        </div>

                        <lightning-layout-item size="12" class="resource-container1">
                            <!-- Insert PP detail page resource item for portrait as well as desktop -->
                            <template if:false={isDocument}>
                                <lightning-layout multiple-rows="true">
                                    <lightning-layout-item size="12">
                                        <c-pp-detail-page-resource-item
                                            resource-link={resourceLink}
                                            resource-type={resourceType}
                                        >
                                        </c-pp-detail-page-resource-item>
                                    </lightning-layout-item>
                                </lightning-layout>
                            </template>
                        </lightning-layout-item>
                    </lightning-layout>
                    <div class="portrait-mode">
                        <hr />
                    </div>
                    <!--****************  Resource Container **********************-->
                    <lightning-layout multiple-rows="true" class="">
                        <!--**************  Article/Videos ******************* -->
                        <template if:false={isDocument}>
                            <lightning-layout-item size="12" class="resource-container portrait-mode">
                                <!-- ***************** Resource Detail ***********************  -->
                                <lightning-layout multiple-rows="true">
                                    <lightning-layout-item size="12" class="title-row">
                                        <lightning-layout multiple-rows="true">
                                            <!--   TITLE    -->
                                            <lightning-layout-item size="10">
                                                <div class="summary-title" onclick={handleNavigate}>
                                                    {resourceTitle}
                                                </div>
                                            </lightning-layout-item>
                                            <!--   STARICON    -->
                                            <lightning-layout-item size="2">
                                                <div
                                                    if:false={isMultimedia}
                                                    class="resource-icon resource-pointer"
                                                    onclick={handleFavourite}
                                                >
                                                    <template if:false={isFavourite}>
                                                        <c-web-icon
                                                            icon-name="icon-star"
                                                            data-id="star"
                                                            data-name="star"
                                                        ></c-web-icon>
                                                    </template>
                                                    <template if:true={isFavourite}>
                                                        <c-web-icon
                                                            icon-name="icon-star-solid"
                                                            data-id="fav-star"
                                                            data-name="fav-star"
                                                            icon-color="#595959"
                                                        ></c-web-icon>
                                                    </template>
                                                </div>
                                            </lightning-layout-item>
                                        </lightning-layout>
                                    </lightning-layout-item>
                                    <!--   Upload Date    -->
                                    <lightning-layout-item size="12">
                                        <div class="summary-date">
                                            {showPostingOrVersionLabel}&nbsp;
                                            <lightning-formatted-date-time
                                                value={resUploadDate}
                                                time-zone={userTimeZone}
                                            >
                                            </lightning-formatted-date-time>
                                        </div>
                                    </lightning-layout-item>
                                    <!--   SUMMARY    -->
                                    <lightning-layout-item size="12">
                                        <div class="summary-text">
                                            <lightning-formatted-rich-text
                                                value={resourceSummary}
                                            ></lightning-formatted-rich-text>
                                        </div>
                                    </lightning-layout-item>
                                    <!-- Article suggestions-->
                                    <lightning-layout-item
                                        size="12"
                                        class="suggested-container slds-p-top_x-large"
                                    >
                                        <template lwc:if={isSuggestedArticlesVisible}>
                                            <c-pp-suggested-articles
                                                resid={resourceId}
                                                suggested-articles-data={suggestedArticlesData}
                                                is-invalid={isInvalidResource}
                                            ></c-pp-suggested-articles>
                                        </template>
                                    </lightning-layout-item>
                                </lightning-layout>
                            </lightning-layout-item>
                        </template>
                        <!-- *************** Study Documents ****************** -->
                        <template if:true={isDocument}>
                            <lightning-layout-item size="12" class="title-row-document">
                                <div class="ah-video-iframe">
                                    <iframe frameborder="0" src={documentLink} class="my_iframe">
                                    </iframe>
                                </div>
                            </lightning-layout-item>
                        </template>
                    </lightning-layout>
                    <!--*************  Resource Container End *************** -->
                </div>
            </template>
        </div>
    </template>
</template>
