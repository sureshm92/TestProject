<!--
 - Created by Leonid Bartenev
 -->

<aura:component description="ParticipantCardHeader" extends="c:CommunityContext">
    <!-- attributes: -->
    <aura:attribute name="userMode" type="String" />
    <aura:attribute name="pe" type="Object" />
    <aura:attribute name="isReferral" type="Boolean" />
    <aura:attribute name="isInvited" type="Boolean" />

    <!--added for the performance issue-->
    <!--aura:attribute name="parent" type="Aura.Component" required="true"/>
    <aura:attribute name="parentSE" type="Aura.Component" required="true"/-->

    <!-- component body: -->
    <div class="{!if(v.isRTL, 'rtl', '')}" style="position: relative"> 
        <div class="slds-grid">
        <aura:if isTrue="{!v.pe.Participant__c}">
                <div class="slds-media__body">
            <aura:if isTrue="{!v.userMode == 'Participant'}">
                <div>
                    <div class="vpi-tile-title">
                        {!v.pe.Study_Site__r.Clinical_Trial_Profile__r.Study_Code_Name__c}
                    </div>
                    <div class="{! if(v.isRTL, 'objective-linkRTL' , 'objective-link')}">
                        <c:RRLink
                            page="{!'study-workspace?id=' + v.pe.Study_Site__r.Clinical_Trial_Profile__c}"
                        >
                            <aura:if isTrue="{!v.isRTL}"
                                >{!$Label.c.BTN_Learn_More}<c:RRIcon iconName="icon-chevron-left"
                            /></aura:if>

                            <aura:if isTrue="{!!v.isRTL}"
                                >{!$Label.c.BTN_Learn_More}<c:RRIcon iconName="icon-chevron-right"
                            /></aura:if>
                        </c:RRLink>
                    </div>
                </div>
                <div class="sponsor-name">
                    {!v.pe.Study_Site__r.Clinical_Trial_Profile__r.Study_Sponsor__c}
                </div>
                <div class="objective-section">
                    <div class="objective-text">
                        {!v.pe.Clinical_Trial_Profile__r.Brief_Summary__c}
                    </div>
                </div>
                <aura:set attribute="else">
                    <aura:if isTrue="{!not(v.isReferral)}">
                        <div  class="vpi-title" style="margin-bottom: 20px">
                            {!v.pe.Participant__r.First_Name__c + ' ' +
                            v.pe.Participant__r.Last_Name__c}
                        </div>
                        <aura:set attribute="else">
                            <aura:if isTrue="{!v.userMode == 'HCP'}">
                                <c:RRLink
                                    class="vpi-title"
                                    page="{!'patient-profile?id=' + v.pe.Participant__c}"
                                    >{!v.pe.Participant__r.First_Name__c + ' ' +
                                    v.pe.Participant__r.Last_Name__c}</c:RRLink
                                >
                                <aura:set attribute="else">
                                    <c:RRLink
                                        class="vpi-title"
                                        page="{!'referral-profile?id=' + v.pe.Id}"
                                        >{!v.pe.Participant__r.First_Name__c + ' ' +
                                        v.pe.Participant__r.Last_Name__c}</c:RRLink
                                    >
                                </aura:set>
                            </aura:if>
                        </aura:set>
                    </aura:if>
                </aura:set>
            </aura:if>
            <aura:set attribute="else">
                <div class="vpi-title" style="margin-bottom: 20px">
                    {!v.pe.Patient_ID__c + if(v.peAdditionalName, ' (' + v.peAdditionalName + ')',
                    '')}
                </div>
            </aura:set>
            </div>
            <div class="slds-no-flex">
            <aura:if isTrue="{!v.userMode == 'PI'}">
                <aura:if isTrue="{!v.pe.Participant__r.Emancipation_in_progress__c}">
                    <div class="slds-has-block-links--space3" data-gtm="Label_Action_Required">
                        {!$Label.c.Action_Required}
                    </div>
                    <aura:set attribute="else">
                        <div
                            class="{!v.isInvited ? 'slds-has-block-links--space' : 'slds-has-block-links--space2'}"
                            data-gtm="{!v.isInvited ? 'Label_Invited' : 'Label_Not_Invited'}"
                        >
                            {!v.isInvited ? $Label.c.Invited : $Label.c.Not_Invited}
                        </div>
                    </aura:set>
                </aura:if>
            </aura:if>
            </div>
            <!--Added for performance tuning -->
            <!--a aura:id="show" class="slds-show custom-plus" onclick="{!c.openCard}"><span>{!$Label.c.View_More}&nbsp;&gt;</span></a-->
        </aura:if>
    </div>
</aura:component>
